---
- hosts: mesos_slave

  tasks:
    - name: Stopping Zookeeper
      service: name=zookeeper state=stopped
    
    - name: Disable Mesos-master and Zookeeper services
      shell: sh -c "{{item}}"
      with_items:
        - echo 'manual' > /etc/init/mesos-master.override
        - echo 'manual' > /etc/init/zookeeper.override
   
    - name: Stopping Mesos-Master service
      service: name=mesos-master state=stopped 
    - name: Restart Mesos-slave service
      service: name=mesos-slave state=reloaded

    - name: Setting up mesos hostname
      shell: /bin/bash source keystone_rc && nova --os-project-name=admin list | grep hostname | awk '{print $13}' > /etc/mesos-slave/hostname
      with_items: '{{play_hosts}}'

